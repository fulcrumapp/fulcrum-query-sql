{"version":3,"sources":["../../src/schema/element-column.js"],"names":["ElementColumn","element","rawColumn","type","id","part","index","_type","_element","_rawColumn","_id","key","_part","_index","valueFrom","feature","isStatusElement","Record","statusValue","StatusValue","recordStatus","formValues","get","exportValue","options","value","format","label","name","dataName","isPhotoElement","isVideoElement","isAudioElement","isSignatureElement","isAttachmentElement","isRepeatableElement","isNumber","isDate","Column"],"mappings":"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","sourcesContent":["import Column from './column';\nimport { StatusValue, Record } from 'fulcrum-core';\n\nexport default class ElementColumn extends Column {\n  constructor({element, rawColumn, type, id, part, index}) {\n    super();\n\n    this._type = type;\n    this._element = element;\n    this._rawColumn = rawColumn;\n    this._id = id || element.key;\n    this._part = part;\n    this._index = index;\n\n    if (part) {\n      this._id += '_' + part;\n    }\n  }\n\n  get type() {\n    return this._type;\n  }\n\n  get name() {\n    if (this.part) {\n      return this.element.label + ' (' + this.part + ')';\n    }\n\n    return this.element.label;\n  }\n\n  get element() {\n    return this._element;\n  }\n\n  get rawColumn() {\n    return this._rawColumn;\n  }\n\n  get columnName() {\n    if (this.rawColumn) {\n      return this.rawColumn.name;\n    }\n\n    if (this.part) {\n      return this.element.dataName + '_' + this.part;\n    }\n\n    return this.element.dataName;\n  }\n\n  get id() {\n    return this._id;\n  }\n\n  get part() {\n    return this._part;\n  }\n\n  valueFrom(feature) {\n    if (this.element.isStatusElement) {\n      if (feature instanceof Record) {\n        return feature.statusValue;\n      }\n\n      return new StatusValue(this.element, feature.recordStatus);\n    }\n\n    return feature.formValues.get(this.element.key);\n  }\n\n  exportValue(feature, options) {\n    const value = this.valueFrom(feature);\n\n    if (value) {\n      return value.format({feature, part: this.part, ...options});\n    }\n\n    return null;\n  }\n\n  get canSearch() {\n    if (this.element.isPhotoElement ||\n        this.element.isVideoElement ||\n        this.element.isAudioElement ||\n        this.element.isSignatureElement ||\n        this.element.isAttachmentElement ||\n        this.element.isRepeatableElement) {\n      return false;\n    }\n\n    return true;\n  }\n\n  get supportsRanges() {\n    // Repeatable columns are an exception, they don't support ranges yet because we don't\n    // have a physical column to query.\n    if (this.element.isRepeatableElement) {\n      return false;\n    }\n\n    return this.isNumber || this.isDate;\n  }\n\n  get isSortable() {\n    if (this.element.isPhotoElement ||\n        this.element.isVideoElement ||\n        this.element.isAudioElement ||\n        this.element.isSignatureElement ||\n        this.element.isAttachmentElement ||\n        this.element.isRepeatableElement) {\n      return false;\n    }\n\n    return true;\n  }\n}\n"],"file":"element-column.js"}